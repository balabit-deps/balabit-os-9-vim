Backported of:

From 9d1bed5eccdbb46a26b8a484f5e9163c40e63919 Mon Sep 17 00:00:00 2001
From: Christian Brabandt <cb@256bit.org>
Date: Mon, 20 Jan 2025 22:55:57 +0100
Subject: [PATCH] patch 9.1.1043: [security]: segfault in win_line()

Problem:  [security]: segfault in win_line()
          (fizz-is-on-the-way)
Solution: Check that ScreenLines is not NULL

Github Advisory:
https://github.com/vim/vim/security/advisories/GHSA-j3g9-wg22-v955

Signed-off-by: Christian Brabandt <cb@256bit.org>
diff --git a/src/gui.c b/src/gui.c
index 7716d64..6d3bc84 100644
--- a/src/gui.c
+++ b/src/gui.c
@@ -4540,12 +4540,12 @@ gui_do_scroll(void)
      * Don't call updateWindow() when nothing has changed (it will overwrite
      * the status line!).
      */
-    if (old_topline != wp->w_topline
+    if (ScreenLines != NULL && (old_topline != wp->w_topline
 	    || wp->w_redr_type != 0
 #ifdef FEAT_DIFF
 	    || old_topfill != wp->w_topfill
 #endif
-	    )
+	    ))
     {
 	int type = VALID;
 
