From 083692d598139228e101b8c521aaef7bcf256e9a Mon Sep 17 00:00:00 2001
From: Bram Moolenaar <Bram@vim.org>
Date: Wed, 29 Jun 2022 21:16:58 +0100
Subject: [PATCH] patch 9.0.0009: going past the end of a menu item with only
 modifier

Problem:    Going past the end of a menu item with only modifier.
Solution:   Check for NUL.
---
 src/message.c             |  4 ++--
 src/testdir/test_menu.vim | 13 +++++++++++++
 src/version.c             |  2 ++
 3 files changed, 17 insertions(+), 2 deletions(-)

--- vim-8.2.3995.orig/src/message.c
+++ vim-8.2.3995/src/message.c
@@ -1806,7 +1806,7 @@ str2special(
 	*sp = str + len;
     }
     else
-	*sp = str + 1;
+	*sp = str + (*str == NUL ? 0 : 1);
 
     // Make unprintable characters in <> form, also <M-Space> and <Tab>.
     // Use <Space> only for lhs of a mapping.
