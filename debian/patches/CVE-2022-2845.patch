From e98c88c44c308edaea5994b8ad4363e65030968c Mon Sep 17 00:00:00 2001
From: Bram Moolenaar <Bram@vim.org>
Date: Tue, 16 Aug 2022 14:51:53 +0100
Subject: [PATCH] patch 9.0.0218: reading before the start of the line

Problem:    Reading before the start of the line.
Solution:   When displaying "$" check the column is not negative.
---
 src/edit.c                  | 3 ++-
 src/proto/edit.pro          | 2 +-
 src/testdir/test_cmdwin.vim | 8 ++++++++
 src/version.c               | 2 ++
 4 files changed, 13 insertions(+), 2 deletions(-)

--- vim-8.2.3995.orig/src/edit.c
+++ vim-8.2.3995/src/edit.c
@@ -1751,8 +1751,9 @@ edit_unputchar(void)
  * Only works when cursor is in the line that changes.
  */
     void
-display_dollar(colnr_T col)
+display_dollar(colnr_T col_arg)
 {
+    colnr_T col = col_arg < 0 ? 0 : col_arg;
     colnr_T save_col;
 
     if (!redrawing())
--- vim-8.2.3995.orig/src/proto/edit.pro
+++ vim-8.2.3995/src/proto/edit.pro
@@ -5,7 +5,7 @@ void ins_redraw(int ready);
 void edit_putchar(int c, int highlight);
 void set_insstart(linenr_T lnum, int col);
 void edit_unputchar(void);
-void display_dollar(colnr_T col);
+void display_dollar(colnr_T col_arg);
 void undisplay_dollar(void);
 void truncate_spaces(char_u *line);
 void backspace_until_column(int col);
